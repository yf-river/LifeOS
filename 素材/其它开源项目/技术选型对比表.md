# 5个参考项目技术选型对比表

## 1. 技术栈矩阵

| 维度 | FastGPT | memos | blinko | khoj | WeKnora |
|------|---------|-------|--------|------|---------|
| **后端语言** | Node.js (TS) | Go | Node.js (TS) | Python | Go |
| **后端框架** | Custom | Echo | Express/tRPC | FastAPI | Gin |
| **前端框架** | Next.js 14 | React | React 18 | React | React |
| **桌面/应用** | - | - | Tauri v2 | Tauri/PyQt/Electron | Docker |
| **数据库** | MongoDB + PG | SQLite/PG | SQLite (Prisma) | PG + pgvector | DuckDB + ES |
| **向量DB** | Milvus/PG Vector | - | - | PG Vector | DuckDB |
| **ORM** | Mongoose | - | Prisma | SQLAlchemy | sqlc (Go) |
| **API 风格** | gRPC-Gateway | gRPC-Gateway | tRPC + REST | REST | REST |
| **包管理** | pnpm | Go Modules | bun | pip + Poetry | Go Modules |
| **任务队列** | Bull/BullMQ | - | - | - | Asynq |
| **缓存** | Redis | - | - | - | Redis (optional) |

---

## 2. 架构模式对比

### A. 单体 vs 微服务

| 项目 | 架构模式 | 优势 | 劣势 |
|------|--------|------|------|
| **FastGPT** | 单体 Monorepo | 高内聚，工作流编排强大 | 扩展性有限 |
| **memos** | 单体 | 轻量级，快速部署 | 功能受限 |
| **blinko** | 单体 (Monorepo) | 简洁，本地优先 | 不支持分布式 |
| **khoj** | 单体 + 多客户端 | 客户端独立开发 | 后端仍需处理多格式 |
| **WeKnora** | 微服务分离 (Go + Python) | 技术栈灵活，独立扩展 | 部署复杂度高 |

**推荐**: 初期单体 (memos/blinko 模式)，后期若有必要拆分文档处理 (WeKnora 模式)

---

### B. 数据库选择

#### 关系数据库

| 选项 | FastGPT | memos | blinko | 特点 |
|------|---------|-------|--------|------|
| **SQLite** | ✗ | ✓ | ✓ | 本地优先，轻量级 |
| **PostgreSQL** | ✓ | ✓ | ✗ | 功能完整，生产级 |
| **MongoDB** | ✓ | ✗ | ✗ | 灵活Schema，适合工作流 |

#### 向量数据库

| 选项 | FastGPT | khoj | WeKnora | 特点 |
|------|---------|------|---------|------|
| **PG Vector** | ✓ | ✓ | ✗ | PostgreSQL 扩展，一体化 |
| **Milvus** | ✓ | ✗ | ✗ | 独立服务，高性能 |
| **DuckDB** | ✗ | ✗ | ✓ | 列式存储，分析友好 |

#### 搜索引擎

| 选项 | 用途 | WeKnora | 特点 |
|------|------|---------|------|
| **Elasticsearch** | 全文搜索 | ✓ | 功能强大，资源消耗大 |
| **SQLite FTS** | 轻量搜索 | ✗ | 简单场景足够 |

**推荐方案**:
```
本地应用:      SQLite (笔记) + SQLite (全文索引)
服务端应用:    PostgreSQL (主数据) + PG Vector (向量)
高性能场景:    PostgreSQL + Milvus
分析场景:      DuckDB
```

---

### C. API 设计方案

| 方案 | FastGPT | memos | blinko | 适用场景 |
|------|---------|-------|--------|---------|
| **gRPC-Gateway** | ✓ | ✓ | ✗ | 类型安全，自动文档生成 |
| **tRPC** | ✗ | ✗ | ✓ | 类型共享，前后端紧密耦合 |
| **REST (OpenAPI)** | ✓ | ✓ | ✓ | 通用，文档友好 |
| **GraphQL** | ✗ | ✗ | ✗ | 灵活查询，学习曲线陡 |

**推荐**: 
- 若前后端紧密耦合: **tRPC** (blinko 模式)
- 若需要多客户端支持: **gRPC-Gateway** (memos 模式)
- 通用方案: **OpenAPI/REST** + Protocol Buffers

---

## 3. 核心功能实现对比

### A. 笔记存储

| 功能 | FastGPT | memos | blinko | khoj |
|------|---------|-------|--------|------|
| **基础 CRUD** | ✓ | ✓ | ✓ | ✓ |
| **版本控制** | ✗ | ✗ | ✗ | ✗ |
| **关系管理** | ✗ | ✓ (分享、收藏) | ~ | ~ |
| **权限控制** | ✓ | ✓ | ~ | ~ |
| **全文搜索** | ✓ | ✓ | ✓ | ✓ |
| **向量搜索** | ✓ | ✗ | ✓ | ✓ |
| **语义链接** | ~ | ✗ | ✗ | ✗ |

### B. AI 能力

| 功能 | FastGPT | blinko | khoj | WeKnora |
|------|---------|--------|------|---------|
| **工作流编排** | ✓✓✓ | ~ | ~ | ~ |
| **工具调用** | ✓ | ✓ (MCP) | ✓ | ✓ |
| **RAG 检索** | ✓ | ✓ | ✓ | ✓ |
| **本地 LLM** | ~ | ✓ (Ollama) | ✓ | ~ |
| **多模型支持** | ~ | ✓ | ✓ | ~ |
| **Agent 能力** | ✓ | ✓ | ✓ | ✓ |
| **GraphRAG** | ✗ | ✗ | ✗ | ✓✓ |

### C. 多端支持

| 端 | FastGPT | memos | blinko | khoj |
|----|---------|-------|--------|------|
| **Web** | ✓ | ✓ | ✓ | ✓ |
| **Desktop (Tauri)** | ✗ | ✗ | ✓ | ~ |
| **Desktop (Electron)** | ✗ | ✗ | ✗ | ✓ |
| **Mobile (Native)** | ✗ | ✗ | ✗ | ✓ |
| **Editor Plugin** | ✗ | ✗ | ✗ | ✓ (Obsidian, Emacs) |
| **CLI** | ✗ | ✗ | ✗ | ✓ |

---

## 4. 性能特征

### 部署方式

| 项目 | 最小部署 | 推荐部署 | 高可用部署 |
|------|--------|--------|----------|
| **FastGPT** | Docker (1容器) | K8s (3+) | K8s 集群 + LB |
| **memos** | 二进制 | Docker | Docker + 负载均衡 |
| **blinko** | Tauri 应用 | Docker (后端) | Docker Swarm/K8s |
| **khoj** | Python venv | Docker | K8s + 多副本 |
| **WeKnora** | Docker Compose | K8s + Helm | K8s 集群 |

### 资源占用

| 项目 | 启动时间 | 内存 (空载) | 存储 | 特点 |
|------|---------|-----------|------|------|
| **FastGPT** | ~30s | 200-300MB | 1GB+ | 功能完整，资源消耗大 |
| **memos** | ~5s | 50-100MB | 100MB | 极轻量级 |
| **blinko** | ~10s | 80-120MB | 500MB | 轻量，Tauri 开销小 |
| **khoj** | ~10s | 150-200MB | 500MB+ | Python 开销 |
| **WeKnora** | ~15s | 300-500MB | 1GB+ | 文档处理消耗大 |

---

## 5. 扩展性对比

### 插件/扩展机制

| 项目 | 扩展方式 | 难度 | 生态 |
|------|--------|------|------|
| **FastGPT** | 工具集、插件 | 中 | 官方插件市场 |
| **memos** | 插件系统 | 中 | 社区插件不多 |
| **blinko** | MCP (深度集成) | 低 | MCP 成为标准 |
| **khoj** | 客户端独立实现 | 中 | 多端生态 |
| **WeKnora** | MCP 服务器 | 中 | 工具链集成 |

### 第三方集成

| 集成方式 | FastGPT | memos | blinko | khoj |
|---------|---------|-------|--------|------|
| **OpenAPI** | ✓ | ✓ | ✓ | ✓ |
| **Webhook** | ✓ | ~ | ~ | ~ |
| **MCP** | ~ | ✗ | ✓✓ | ✓ |
| **插件系统** | ✓ | ✓ | ✓ | ~ |

---

## 6. 学习难度对比

| 项目 | 架构复杂度 | 代码难度 | 文档完整性 | 社区活跃度 |
|------|----------|--------|----------|----------|
| **FastGPT** | 高 | 高 (TS) | 中 | 高 |
| **memos** | 低 | 低 (Go) | 好 | 中 |
| **blinko** | 中 | 中 (TS) | 中 | 中 |
| **khoj** | 中 | 中 (Python) | 中 | 中 |
| **WeKnora** | 高 | 高 (Go+Python) | 中 | 低 |

---

## 7. Prism 的最优选择

### 核心技术栈建议

```
后端:
  语言:      Go (参考: memos, WeKnora)
  框架:      Gin (参考: WeKnora)
  理由:      编译性能好、部署简单、并发高效
  
前端 (Web):
  框架:      React 18
  状态管理: Zustand (轻量)
  UI库:     Shadcn/ui (Tailwind)
  
桌面:
  框架:      Tauri v2 (参考: blinko, Lumina-Note)
  理由:      轻量级、内存占用小、打包体积小
  
数据库 (本地):
  SQL:       SQLite + SQLAlchemy
  向量:      SQLite Vector (轻量) 或 Ollama 本地
  
数据库 (服务端):
  SQL:       PostgreSQL + sqlc (Go类型安全)
  向量:      PG Vector (一体化)
  搜索:      SQLite FTS (简单) 或 Elasticsearch (高级)
  
API 设计:
  主要 API:  Protocol Buffers + gRPC-Gateway
  理由:      类型安全、自动生成文档、支持多语言客户端
  
AI 能力:
  LLM 集成:  本地(Ollama) + 云端(OpenAI)
  工具链:    MCP (参考: blinko)
  RAG:       向量搜索 + 混合检索
  进阶:      GraphRAG (思维模型关系图)
```

### 架构决策路径

**第一阶段 (MVP)** - 本地优先
```
- Tauri 桌面应用
- SQLite 本地数据库
- 嵌入式 AI (Ollama)
- 基础 CRUD + 搜索
- 时间轴展示
```

**第二阶段 (AI 增强)** - 工具链
```
- 实现工具（笔记 CRUD、搜索、图谱）
- MCP 作为工具协议
- 工作流编排（参考 FastGPT）
- Agent 能力
```

**第三阶段 (服务端)** - 云端支持
```
- Go 后端服务
- PostgreSQL 主数据库
- PG Vector 向量存储
- 用户认证和权限
- Web 应用
```

**第四阶段 (多端)** - 生态扩展
```
- 浏览器扩展
- 编辑器插件 (Obsidian, VSCode)
- CLI 工具
- 移动 Web
```

---

## 8. 常见陷阱避坑指南

### 技术陷阱

| 陷阱 | 症状 | 避免方案 |
|------|------|--------|
| **过度设计** | API 设计过度复杂 | 参考 memos 的极简 API |
| **不可维护的工作流** | 节点编排逻辑混乱 | 参考 FastGPT 的 dispatch 分离模式 |
| **多数据库同步** | 数据一致性问题 | 单一数据源 (memos 模式) 或 CQRS |
| **向量搜索无效** | 检索质量差 | 实现混合检索 + 重排 (FastGPT 模式) |
| **AI 工具链复杂** | 工具定义混乱 | 采用 MCP 标准化 |

### 部署陷阱

| 陷阱 | 症状 | 避免方案 |
|------|------|--------|
| **本地优先但不支持离线** | 依赖网络 | 从 blinko 学习完全本地化 |
| **过度依赖外部 API** | 服务不可用 | 集成本地 LLM (Ollama) |
| **数据迁移困难** | 用户锁定 | 设计开放的数据格式 (JSON/SQLite) |
| **内存泄漏** | 长期运行崩溃 | Go 内存安全 > Python/Node.js |

---

## 9. 技术决策矩阵

### 选择标准

```
选择标准      优先级  FastGPT  memos  blinko  khoj  WeKnora
高性能          ★★★    ★★      ★★★   ★★★    ★★    ★★
轻量级          ★★★    ★        ★★★   ★★    ★      ★
本地优先        ★★★    ★        ★★    ★★★   ★★    ★
易部署          ★★★    ★★       ★★★   ★★★   ★     ★★
AI能力          ★★★    ★★★      ★★    ★★    ★★   ★★★
多端支持        ★★      ★        ★      ★      ★★★   ★
图谱能力        ★★      ★        ★      ★      ★      ★★★
社区生态        ★★      ★★★      ★★    ★★    ★     ★
```

### 最终评分

| 维度 | FastGPT | memos | blinko | khoj | WeKnora |
|------|---------|-------|--------|------|---------|
| **推荐度 (Prism)** | 70% | 85% | 90% | 75% | 65% |
| **学习价值** | 高 | 高 | 最高 | 高 | 高 |
| **可直接借用** | 工作流 | API | 整体 | 多端 | 文档处理 |

---

## 快速参考

### 如果你想要...

**快速原型** → memos (极简 API + Go 快速开发)
**本地优先应用** → blinko (Tauri + SQLite 完整方案)
**AI 工作流** → FastGPT (工作流编排学习)
**多端支持** → khoj (跨平台客户端参考)
**高级 RAG** → WeKnora (GraphRAG 和文档处理)

### 推荐阅读顺序

1. **memos** - 理解基础架构 (1-2天)
2. **blinko** - 学习本地优先设计 (1-2天)
3. **FastGPT** - 理解工作流编排 (2-3天)
4. **khoj** - 了解多端架构 (1天)
5. **WeKnora** - 深入 GraphRAG (2-3天)

---

**更新时间**: 2026-01-03
**深度等级**: 代码级别 + 架构级别
**用途**: Prism 技术栈决策
